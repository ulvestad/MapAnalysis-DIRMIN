<!DOCTYPE html>
<html>
<body>

<script>
var fs = require('fs');
var files = fs.readdirSync('userInterface/metadata/');

var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        xmlparser(this);
    }
};

var newFilename;
function metadataFilename(files) {
  for (newFilename of files) {
    console.log(newFilename);
    xhttp.open("GET", "metadata/" + newFilename, true);
    xhttp.send();
  }
}
metadataFilename(files);



function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function xmlparser(xml) {
    var xmlDoc = xml.responseXML;
    east =
    xmlDoc.getElementsByTagName("eastBP")[0].childNodes[0].nodeValue;
    console.log(east);

    west =
    xmlDoc.getElementsByTagName("westBP")[0].childNodes[0].nodeValue;
    console.log(west);

    north =
    xmlDoc.getElementsByTagName("northBP")[0].childNodes[0].nodeValue;
    console.log(north);

    south =
    xmlDoc.getElementsByTagName("southBP")[0].childNodes[0].nodeValue;
    console.log(south);

    filename =
    xmlDoc.getElementsByTagName("mdFilename")[0].childNodes[0].nodeValue;
    console.log(filename);


    var textToSave = [east, west, north, south, filename];
    var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
    var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
    var fileNameToSaveAs = "coordinates.txt";

    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    downloadLink.href = textToSaveAsURL;
    downloadLink.onclick = destroyClickedElement;
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);

    downloadLink.click();
}
</script>

</body>
</html>
